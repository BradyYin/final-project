<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Chat Website</title>
    <style>
        /* Previous styles remain the same */
        .friend-request {
            padding: 10px;
            background-color: #e7f3ff;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        .friend-request button {
            margin-left: 10px;
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .accept-btn {
            background-color: #1877f2;
            color: white;
        }
        .reject-btn {
            background-color: #dc3545;
            color: white;
        }
        .tabs {
            display: flex;
            margin-bottom: 15px;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background-color: #f0f2f5;
            border: none;
            margin-right: 5px;
        }
        .tab.active {
            background-color: #1877f2;
            color: white;
        }
        .search-container {
            margin-bottom: 15px;
        }
        .search-container input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .user-status {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }
        .online {
            background-color: #28a745;
        }
        .offline {
            background-color: #dc3545;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <h1>Social Chat</h1>
        </div>
        <div id="userInfo" style="display: none;">
            <span id="username"></span>
            <button onclick="logout()">Logout</button>
        </div>
    </div>
    
    <div id="authContainer" class="auth-container">
        <div class="auth-form">
            <h2 id="authTitle">Login</h2>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" required>
            </div>
            <div class="form-group">
                <label for="password">Password:</label>
                <input type="password" id="password" required>
            </div>
            <div id="registerFields" style="display: none;">
                <div class="form-group">
                    <label for="username">Username:</label>
                    <input type="text" id="usernameInput" required>
                </div>
                <div class="form-group">
                    <label for="confirmPassword">Confirm Password:</label>
                    <input type="password" id="confirmPassword" required>
                </div>
            </div>
            <div class="auth-buttons">
                <button onclick="submitAuth()">Submit</button>
                <button onclick="toggleAuth()">Switch to Register</button>
            </div>
        </div>
    </div>

    <div class="container">
        <div id="chatContainer" class="chat-container">
            <div class="sidebar">
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('friends')">Friends</button>
                    <button class="tab" onclick="switchTab('requests')">Requests</button>
                    <button class="tab" onclick="switchTab('search')">Find Users</button>
                </div>

                <div id="friendsTab">
                    <h2>Friends</h2>
                    <ul class="user-list" id="friendsList">
                        <!-- Friends will be listed here -->
                    </ul>
                </div>

                <div id="requestsTab" style="display: none;">
                    <h2>Friend Requests</h2>
                    <div id="friendRequests">
                        <!-- Friend requests will be shown here -->
                    </div>
                </div>

                <div id="searchTab" style="display: none;">
                    <h2>Find Users</h2>
                    <div class="search-container">
                        <input type="text" id="searchInput" placeholder="Search users..." onkeyup="searchUsers()">
                    </div>
                    <ul class="user-list" id="searchResults">
                        <!-- Search results will be shown here -->
                    </ul>
                </div>
            </div>
            
            <div class="chat-area">
                <div class="message-box" id="messageBox">
                    <!-- Messages will be displayed here -->
                </div>
                <div class="input-area">
                    <input type="text" id="messageInput" placeholder="Type your message...">
                    <button onclick="sendMessage()">Send</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Mock database for demo purposes
        let users = [
            { id: 1, email: 'user1@example.com', username: 'User1', friends: [], friendRequests: [] },
            { id: 2, email: 'user2@example.com', username: 'User2', friends: [], friendRequests: [] },
            { id: 3, email: 'user3@example.com', username: 'User3', friends: [], friendRequests: [] }
        ];

        let isLogin = true;
        let currentUser = null;

        function toggleAuth() {
            isLogin = !isLogin;
            document.getElementById('authTitle').textContent = isLogin ? 'Login' : 'Register';
            document.getElementById('registerFields').style.display = isLogin ? 'none' : 'block';
        }

        function submitAuth() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            if (isLogin) {
                // Login logic
                const user = users.find(u => u.email === email);
                if (user) {
                    currentUser = user;
                    loginSuccess();
                } else {
                    alert('User not found!');
                }
            } else {
                // Register logic
                const username = document.getElementById('usernameInput').value;
                const confirmPassword = document.getElementById('confirmPassword').value;

                if (email && password && username && confirmPassword) {
                    if (password !== confirmPassword) {
                        alert('Passwords do not match!');
                        return;
                    }
                    // Create new user
                    const newUser = {
                        id: users.length + 1,
                        email: email,
                        username: username,
                        friends: [],
                        friendRequests: []
                    };
                    users.push(newUser);
                    currentUser = newUser;
                    loginSuccess();
                }
            }
        }

        function loginSuccess() {
            document.getElementById('authContainer').style.display = 'none';
            document.getElementById('chatContainer').style.display = 'flex';
            document.getElementById('userInfo').style.display = 'block';
            document.getElementById('username').textContent = currentUser.username;
            updateFriendsList();
            updateFriendRequests();
        }

        function logout() {
            currentUser = null;
            document.getElementById('authContainer').style.display = 'flex';
            document.getElementById('chatContainer').style.display = 'none';
            document.getElementById('userInfo').style.display = 'none';
            clearFormFields();
        }

        function clearFormFields() {
            document.getElementById('email').value = '';
            document.getElementById('password').value = '';
            document.getElementById('usernameInput').value = '';
            document.getElementById('confirmPassword').value = '';
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`[onclick="switchTab('${tab}')"]`).classList.add('active');
            
            document.getElementById('friendsTab').style.display = tab === 'friends' ? 'block' : 'none';
            document.getElementById('requestsTab').style.display = tab === 'requests' ? 'block' : 'none';
            document.getElementById('searchTab').style.display = tab === 'search' ? 'block' : 'none';
        }

        function searchUsers() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const searchResults = users.filter(user => 
                user.id !== currentUser.id && 
                !currentUser.friends.includes(user.id) &&
                user.username.toLowerCase().includes(searchTerm)
            );

            const searchResultsElement = document.getElementById('searchResults');
            searchResultsElement.innerHTML = '';
            
            searchResults.forEach(user => {
                const li = document.createElement('li');
                li.innerHTML = `
                    ${user.username}
                    <button onclick="sendFriendRequest(${user.id})">Add Friend</button>
                `;
                searchResultsElement.appendChild(li);
            });
        }

        function sendFriendRequest(userId) {
            const targetUser = users.find(u => u.id === userId);
            if (targetUser && !targetUser.friendRequests.includes(currentUser.id)) {
                targetUser.friendRequests.push(currentUser.id);
                alert(`Friend request sent to ${targetUser.username}`);
            }
        }

        function updateFriendRequests() {
            const requestsContainer = document.getElementById('friendRequests');
            requestsContainer.innerHTML = '';

            currentUser.friendRequests.forEach(requesterId => {
                const requester = users.find(u => u.id === requesterId);
                const requestElement = document.createElement('div');
                requestElement.className = 'friend-request';
                requestElement.innerHTML = `
                    ${requester.username} wants to be your friend
                    <button class="accept-btn" onclick="acceptFriendRequest(${requester.id})">Accept</button>
                    <button class="reject-btn" onclick="rejectFriendRequest(${requester.id})">Reject</button>
                `;
                requestsContainer.appendChild(requestElement);
            });
        }

        function acceptFriendRequest(requesterId) {
            currentUser.friends.push(requesterId);
            const requester = users.find(u => u.id === requesterId);
            requester.friends.push(currentUser.id);
            
            currentUser.friendRequests = currentUser.friendRequests.filter(id => id !== requesterId);
            
            updateFriendsList();
            updateFriendRequests();
        }

        function rejectFriendRequest(requesterId) {
            currentUser.friendRequests = currentUser.friendRequests.filter(id => id !== requesterId);
            updateFriendRequests();
        }

        function updateFriendsList() {
            const friendsList = document.getElementById('friendsList');
            friendsList.innerHTML = '';

            currentUser.friends.forEach(friendId => {
                const friend = users.find(u => u.id === friendId);
                const li = document.createElement('li');
                li.innerHTML = `
                    <span class="user-status ${Math.random() > 0.5 ? 'online' : 'offline'}"></span>
                    ${friend.username}
                `;
                friendsList.appendChild(li);
            });
        }

        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const messageBox = document.getElementById('messageBox');
            
            if (messageInput.value.trim() !== '') {
                const messageElement = document.createElement('p');
                messageElement.textContent = `${currentUser.username}: ${messageInput.value}`;
                messageBox.appendChild(messageElement);
                messageInput.value = '';
                messageBox.scrollTop = messageBox.scrollHeight;
            }
        }

        // Allow sending message with Enter key
        document.getElementById('messageInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    </script>
</body>
</html>


